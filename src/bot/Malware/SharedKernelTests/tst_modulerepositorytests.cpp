#include "tst_modulerepositorytests.h"

void ModuleRepositoryTests::initTestCase()
{
    this->repo_ = new systems::windows::WindowsModuleRepository();
    this->processRepo_ = new systems::windows::WindowsProcessRepository();
}

void ModuleRepositoryTests::cleanupTestCase()
{
    delete this->repo_;
    delete this->processRepo_;
}

void ModuleRepositoryTests::isModuleLoaded_CheckForKernel32InItself_ShouldExist()
{
    // Arrange
    auto currentProcess = this->processRepo_->getCurrentProcess();

    // Act
    auto isLoaded = this->repo_->isModuleLoaded(currentProcess, "KERNEL32.DLL");

    // Assert
    QVERIFY2(isLoaded, "Kernel32 must be loaded in the current process.");
}
