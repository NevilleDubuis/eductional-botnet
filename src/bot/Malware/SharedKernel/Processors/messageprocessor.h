#ifndef MESSAGEPROCESSOR_H
#define MESSAGEPROCESSOR_H

#include <memory>

#include "../Network/serveradapter.h"
#include "../Network/Messages/Server/servermessage.h"
#include "messageprocessorbase.h"

namespace processors
{
    /**
     * @brief A helper template that provides a strongly type inheritance to handle messages.
     */
    template<class TMessage>
    class MessageProcessor : public MessageProcessorBase
    {
    public:
        /**
         * @brief Processes the given \e message.
         * @param message The message to process.
         * @param serverAdapter A reference to the server adapter.
         */
        void process(std::shared_ptr<network::messages::server::ServerMessage> message, network::ServerAdapter& serverAdapter) override
        {
            auto stronglyTypedMessage = std::dynamic_pointer_cast<TMessage> (message);

            if(stronglyTypedMessage)
            {
                process(stronglyTypedMessage, serverAdapter);
            }
        }

        /**
         * @brief Processes the given \e message.
         * @param message The message to process.
         * @param serverAdapter A reference to the server adapter.
         */
        virtual void process(std::shared_ptr<TMessage> message, network::ServerAdapter& serverAdapter) = 0;
    };
}

#endif // MESSAGEPROCESSOR_H
