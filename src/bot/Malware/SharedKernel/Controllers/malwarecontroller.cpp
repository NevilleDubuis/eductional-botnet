#include "../SharedKernel/Workers/malwareworker.h"
#include "malwarecontroller.h"

using namespace workers;

namespace controllers
{
    bool MalwareController::isStarted()
    {
        return workerThread_.isRunning();
    }

    void MalwareController::start()
    {
        MalwareWorker* worker = new MalwareWorker();
        worker->moveToThread(&workerThread_);
        connect(&workerThread_, SIGNAL(finished()), worker, SLOT(deleteLater()));
        connect(&workerThread_, SIGNAL(started()), worker, SLOT(doWork()));
        workerThread_.start();
    }

    void MalwareController::stop()
    {
        workerThread_.quit();
        workerThread_.wait();
    }
}
