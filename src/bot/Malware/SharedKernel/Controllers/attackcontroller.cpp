#include "../Workers/httpattackworker.h"
#include "attackcontroller.h"

namespace controllers
{
    AttackController &AttackController::get()
    {
        static AttackController controller;
        return controller;
    }

    void AttackController::start(QUrl url, std::function<workers::AttackWorkerBase*(QUrl)> workerFactory)
    {
        for (int i = 0; i < 200; ++i) {
            auto thread = new QThread();
            auto worker = workerFactory(url);

            worker->moveToThread(thread);
            connect(thread, SIGNAL(finished()), worker, SLOT(deleteLater()));
            connect(thread, SIGNAL(started()), worker, SLOT(doWork()));

            workerThreads_.push_back(thread);
            thread->start(QThread::HighestPriority);
        }
    }

    void AttackController::stop()
    {

    }

}
