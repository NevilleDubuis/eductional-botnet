#ifndef HTTPATTACKWORKER_H
#define HTTPATTACKWORKER_H

#include <memory>

#include <QByteArray>
#include <QHostAddress>
#include <QTcpSocket>

#include "attackworkerbase.h"

namespace workers
{
    class HttpAttackWorker : public AttackWorkerBase

    {
        Q_OBJECT

    public:
        HttpAttackWorker(QUrl host);
        void setSingleShot(bool singleShot);

    private:
        void generateHttpHeader();
        bool initializeConnection();
        void sendPayload();
        bool tryObtainIp();

        QByteArray httpHeaderAsByteArray_;
        QString ip_;
        bool isSingleShot_;
        std::unique_ptr<QTcpSocket> socket_;

    public slots:
        void doWork() override;
    };
}

#endif // HTTPATTACKWORKER_H
